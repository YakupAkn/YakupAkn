<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Neon Simon | YDA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bgDark: '#0a0a0a',
                        neonGreen: '#39ff14',
                        neonRed: '#ff073a',
                        neonYellow: '#fff01f',
                        neonBlue: '#00f9ff'
                    },
                    boxShadow: {
                        'neon-green': '0 0 20px #39ff14, 0 0 40px #39ff14',
                        'neon-red': '0 0 20px #ff073a, 0 0 40px #ff073a',
                        'neon-yellow': '0 0 20px #fff01f, 0 0 40px #fff01f',
                        'neon-blue': '0 0 20px #00f9ff, 0 0 40px #00f9ff',
                    }
                }
            }
        }
    </script>
    <style>
        body { touch-action: manipulation; } /* Mobilde çift tıklama zoomunu engeller */
        
        .simon-btn {
            opacity: 0.3;
            transition: all 0.1s;
            border: 2px solid transparent;
        }

        .simon-btn.active {
            opacity: 1;
            transform: scale(0.95);
        }

        /* Renkler aktif olduğunda parlasın */
        .simon-btn[data-color="green"].active { box-shadow: 0 0 30px #39ff14; background-color: #39ff14; border-color: #fff; }
        .simon-btn[data-color="red"].active { box-shadow: 0 0 30px #ff073a; background-color: #ff073a; border-color: #fff; }
        .simon-btn[data-color="yellow"].active { box-shadow: 0 0 30px #fff01f; background-color: #fff01f; border-color: #fff; }
        .simon-btn[data-color="blue"].active { box-shadow: 0 0 30px #00f9ff; background-color: #00f9ff; border-color: #fff; }

        /* Oyun alanı merkezi */
        .game-board {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.1);
        }
    </style>
</head>
<body class="bg-bgDark text-white h-screen flex flex-col items-center justify-center font-mono overflow-hidden select-none">
    
    <div class="absolute top-10 text-center z-10">
        <h1 class="text-3xl font-black tracking-[0.2em] mb-1">NEON <span class="text-neonBlue">SIMON</span></h1>
        <div id="status-text" class="text-sm text-gray-400 font-bold uppercase tracking-widest transition-colors duration-300">Başlamak için butona bas</div>
        <div class="mt-2 text-2xl font-bold">SKOR: <span id="level-indicator" class="text-neonBlue">0</span></div>
    </div>

    <div class="game-board relative">
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 h-20 bg-bgDark rounded-full z-10 flex items-center justify-center border border-white/10">
            <div class="w-16 h-16 rounded-full bg-black/50 flex items-center justify-center">
                <span class="text-xs text-gray-600">YDA</span>
            </div>
        </div>

        <div id="green" data-color="green" class="simon-btn w-32 h-32 sm:w-40 sm:h-40 bg-green-600 rounded-tl-[100px] cursor-pointer hover:opacity-50"></div>
        <div id="red" data-color="red" class="simon-btn w-32 h-32 sm:w-40 sm:h-40 bg-red-600 rounded-tr-[100px] cursor-pointer hover:opacity-50"></div>
        <div id="yellow" data-color="yellow" class="simon-btn w-32 h-32 sm:w-40 sm:h-40 bg-yellow-500 rounded-bl-[100px] cursor-pointer hover:opacity-50"></div>
        <div id="blue" data-color="blue" class="simon-btn w-32 h-32 sm:w-40 sm:h-40 bg-blue-600 rounded-br-[100px] cursor-pointer hover:opacity-50"></div>
    </div>

    <div class="mt-12 flex gap-4 z-20">
        <button id="start-btn" onclick="startGame()" class="px-8 py-3 bg-neonBlue/20 border border-neonBlue/50 text-neonBlue font-bold rounded-full hover:bg-neonBlue hover:text-black transition shadow-[0_0_20px_rgba(0,249,255,0.2)]">BAŞLA</button>
        <a href="index.html" class="px-8 py-3 border border-white/20 text-gray-400 font-bold rounded-full hover:bg-white/10 hover:text-white transition">ÇIKIŞ</a>
    </div>

    <script>
        // --- SES MOTORU (Web Audio API) ---
        // Harici dosya kullanmadan ses üretir.
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        const frequencies = {
            'green': 329.63, // E4
            'red': 261.63,   // C4
            'yellow': 392.00, // G4
            'blue': 440.00,   // A4
            'error': 110.00   // A2 (Hata sesi)
        };

        function playTone(color, duration = 300) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            oscillator.type = color === 'error' ? 'sawtooth' : 'sine';
            oscillator.frequency.value = frequencies[color];
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.start();
            
            // Sesi yumuşakça bitir (çıtırtıyı önler)
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration / 1000);
            
            setTimeout(() => {
                oscillator.stop();
            }, duration);
        }

        // --- OYUN MANTIĞI ---
        const colors = ['green', 'red', 'yellow', 'blue'];
        let sequence = [];
        let playerSequence = [];
        let level = 0;
        let isInputBlocked = true;
        let gameSpeed = 600; // Başlangıç hızı (ms)

        const statusText = document.getElementById('status-text');
        const levelDisplay = document.getElementById('level-indicator');
        const startBtn = document.getElementById('start-btn');

        // Butonlara tıklama olaylarını ekle
        document.querySelectorAll('.simon-btn').forEach(btn => {
            btn.addEventListener('mousedown', () => {
                if (isInputBlocked) return;
                const color = btn.getAttribute('data-color');
                handlePlayerInput(color);
            });
            // Dokunmatik ekranlar için
            btn.addEventListener('touchstart', (e) => {
                e.preventDefault(); // Zoomu engelle
                if (isInputBlocked) return;
                const color = btn.getAttribute('data-color');
                handlePlayerInput(color);
            });
        });

        function startGame() {
            sequence = [];
            playerSequence = [];
            level = 0;
            gameSpeed = 600;
            levelDisplay.innerText = 0;
            startBtn.classList.add('hidden'); // Başla butonunu gizle
            statusText.classList.remove('text-red-500');
            nextRound();
        }

        function nextRound() {
            level++;
            levelDisplay.innerText = level;
            playerSequence = [];
            
            // Hızlandırma mantığı (Min 200ms'e kadar düşer)
            if (gameSpeed > 200) gameSpeed -= 30;

            // Rastgele renk ekle
            const randomColor = colors[Math.floor(Math.random() * 4)];
            sequence.push(randomColor);

            playSequence();
        }

        function playSequence() {
            isInputBlocked = true;
            statusText.innerText = "İZLE...";
            statusText.className = "text-sm text-neonYellow font-bold uppercase tracking-widest animate-pulse";

            let i = 0;
            const interval = setInterval(() => {
                const color = sequence[i];
                activateButton(color);
                i++;
                
                if (i >= sequence.length) {
                    clearInterval(interval);
                    setTimeout(() => {
                        isInputBlocked = false;
                        statusText.innerText = "SIRA SENDE!";
                        statusText.className = "text-sm text-neonGreen font-bold uppercase tracking-widest";
                    }, gameSpeed); // Son yanıştan sonra bekle
                }
            }, gameSpeed); // Hıza göre yanıp sönme aralığı
        }

        function activateButton(color) {
            const btn = document.getElementById(color);
            btn.classList.add('active');
            playTone(color, gameSpeed / 2); // Ses süresi hızın yarısı kadar
            
            setTimeout(() => {
                btn.classList.remove('active');
            }, gameSpeed / 2);
        }

        function handlePlayerInput(color) {
            activateButton(color);
            playerSequence.push(color);

            // Doğruluk kontrolü
            const index = playerSequence.length - 1;
            
            if (playerSequence[index] !== sequence[index]) {
                gameOver();
                return;
            }

            // Eğer oyuncu tüm diziyi doğru yaptıysa
            if (playerSequence.length === sequence.length) {
                isInputBlocked = true;
                statusText.innerText = "BAŞARILI!";
                setTimeout(nextRound, 1000);
            }
        }

        function gameOver() {
            isInputBlocked = true;
            playTone('error', 800);
            
            statusText.innerText = "SİSTEM HATASI! (KAYBETTİN)";
            statusText.className = "text-sm text-neonRed font-bold uppercase tracking-widest";
            
            // Ekranı kırmızı yapıp söndür
            document.body.style.backgroundColor = '#300';
            setTimeout(() => document.body.style.backgroundColor = '#0a0a0a', 200);
            setTimeout(() => document.body.style.backgroundColor = '#300', 400);
            setTimeout(() => document.body.style.backgroundColor = '#0a0a0a', 600);

            startBtn.innerText = "TEKRAR DENE";
            startBtn.classList.remove('hidden');
        }
    </script>
</body>
</html>